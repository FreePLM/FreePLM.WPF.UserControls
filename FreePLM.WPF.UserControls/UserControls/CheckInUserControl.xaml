<UserControl x:Class="FreePLM.WPF.UserControls.UserControls.CheckInUserControl"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:converters="clr-namespace:FreePLM.WPF.Core.Converters.Single;assembly=FreePLM.WPF.Core"
             mc:Ignorable="d"
             d:DesignHeight="400" d:DesignWidth="500"
             Background="White">
    <UserControl.Resources>
        <BooleanToVisibilityConverter x:Key="BoolToVisConverter"/>
        <converters:InverseBooleanConverter x:Key="InverseBoolConverter"/>
        <converters:NullToVisibilityConverter x:Key="NullToVisibilityConverter"/>

        <Style TargetType="TextBlock" x:Key="LabelStyle">
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="Margin" Value="0,0,0,5"/>
            <Setter Property="Foreground" Value="#333333"/>
        </Style>

        <Style TargetType="TextBlock" x:Key="ValueStyle">
            <Setter Property="Margin" Value="0,0,0,15"/>
            <Setter Property="Foreground" Value="#666666"/>
        </Style>

        <Style TargetType="Button">
            <Setter Property="Padding" Value="20,8"/>
            <Setter Property="MinWidth" Value="100"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Style.Triggers>
                <Trigger Property="IsEnabled" Value="False">
                    <Setter Property="Cursor" Value="Arrow"/>
                </Trigger>
            </Style.Triggers>
        </Style>
    </UserControl.Resources>

    <Grid Margin="20">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Title -->
        <TextBlock Grid.Row="0"
                   Text="Check In Document"
                   FontSize="20"
                   FontWeight="Bold"
                   Margin="0,0,0,20"
                   Foreground="#0078D4"/>

        <!-- Document Information Section -->
        <Border Grid.Row="1"
                BorderBrush="#E0E0E0"
                BorderThickness="1"
                Padding="15"
                Margin="0,0,0,20"
                Background="#F9F9F9">
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>

                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="120"/>
                    <ColumnDefinition Width="*"/>
                </Grid.ColumnDefinitions>

                <!-- Object ID -->
                <TextBlock Grid.Row="0" Grid.Column="0"
                           Text="Object ID:"
                           Style="{StaticResource LabelStyle}"/>
                <TextBlock Grid.Row="0" Grid.Column="1"
                           Text="{Binding ObjectId}"
                           Style="{StaticResource ValueStyle}"/>

                <!-- File Name -->
                <TextBlock Grid.Row="1" Grid.Column="0"
                           Text="File Name:"
                           Style="{StaticResource LabelStyle}"/>
                <TextBlock Grid.Row="1" Grid.Column="1"
                           Text="{Binding FileName}"
                           Style="{StaticResource ValueStyle}"/>

                <!-- Current Revision -->
                <TextBlock Grid.Row="2" Grid.Column="0"
                           Text="Current Revision:"
                           Style="{StaticResource LabelStyle}"/>
                <TextBlock Grid.Row="2" Grid.Column="1"
                           Text="{Binding CurrentRevision}"
                           Style="{StaticResource ValueStyle}"
                           Margin="0"/>
            </Grid>
        </Border>

        <!-- Revision Type Selection -->
        <StackPanel Grid.Row="2" Margin="0,0,0,20">
            <TextBlock Text="Revision Type:"
                       Style="{StaticResource LabelStyle}"/>
            <StackPanel Orientation="Horizontal">
                <RadioButton Content="Minor Revision (e.g., A.01 → A.02)"
                             IsChecked="{Binding CreateMajorRevision, Converter={StaticResource InverseBoolConverter}}"
                             Margin="0,0,20,0"
                             VerticalAlignment="Center"/>
                <RadioButton Content="Major Revision (e.g., A → B)"
                             IsChecked="{Binding CreateMajorRevision}"
                             VerticalAlignment="Center"/>
            </StackPanel>
        </StackPanel>

        <!-- Comment Input -->
        <StackPanel Grid.Row="3" Margin="0,0,0,10">
            <TextBlock Text="Check-In Comment: *"
                       Style="{StaticResource LabelStyle}"/>
            <TextBox Text="{Binding Comment, UpdateSourceTrigger=PropertyChanged}"
                     TextWrapping="Wrap"
                     AcceptsReturn="True"
                     VerticalScrollBarVisibility="Auto"
                     MinHeight="80"
                     MaxHeight="120"
                     Padding="8"
                     BorderBrush="#CCCCCC"
                     IsEnabled="{Binding IsProcessing, Converter={StaticResource InverseBoolConverter}}"/>
            <TextBlock Text="{Binding Path=Comment.Length, StringFormat='Characters: {0}/500'}"
                       Foreground="#999999"
                       FontSize="11"
                       Margin="0,3,0,0"
                       HorizontalAlignment="Right"/>
        </StackPanel>

        <!-- Validation Error Message -->
        <Border Grid.Row="4"
                Background="#FFF4F4"
                BorderBrush="#E74C3C"
                BorderThickness="1"
                Padding="10"
                Margin="0,0,0,10"
                Visibility="{Binding ValidationError, Converter={StaticResource NullToVisibilityConverter}}">
            <StackPanel Orientation="Horizontal">
                <TextBlock Text="⚠"
                           Foreground="#E74C3C"
                           FontSize="16"
                           Margin="0,0,8,0"
                           VerticalAlignment="Center"/>
                <TextBlock Text="{Binding ValidationError}"
                           Foreground="#E74C3C"
                           TextWrapping="Wrap"
                           VerticalAlignment="Center"/>
            </StackPanel>
        </Border>

        <!-- Processing Indicator -->
        <StackPanel Grid.Row="5"
                    Orientation="Horizontal"
                    HorizontalAlignment="Center"
                    Margin="0,10"
                    Visibility="{Binding IsProcessing, Converter={StaticResource BoolToVisConverter}}">
            <TextBlock Text="Processing check-in..."
                       Foreground="#0078D4"
                       VerticalAlignment="Center"
                       Margin="0,0,10,0"/>
            <ProgressBar IsIndeterminate="True"
                         Width="100"
                         Height="4"/>
        </StackPanel>

        <!-- Action Buttons -->
        <StackPanel Grid.Row="6"
                    Orientation="Horizontal"
                    HorizontalAlignment="Right"
                    Margin="0,20,0,0">
            <Button Content="Check In"
                    Command="{Binding CheckInCommand}"
                    IsDefault="True"
                    Background="#0078D4"
                    Foreground="White"
                    BorderBrush="#0078D4"
                    Margin="0,0,10,0">
                <Button.Style>
                    <Style TargetType="Button" BasedOn="{StaticResource {x:Type Button}}">
                        <Style.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter Property="Background" Value="#005A9E"/>
                            </Trigger>
                        </Style.Triggers>
                    </Style>
                </Button.Style>
            </Button>
            <Button Content="Cancel"
                    Command="{Binding CancelCommand}"
                    IsCancel="True"/>
        </StackPanel>
    </Grid>
</UserControl>
